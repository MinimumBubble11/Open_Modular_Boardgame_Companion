"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _archiver = _interopRequireDefault(require("archiver"));
var _fs = _interopRequireDefault(require("fs"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
/**
 * ZipFileUtil
 */
class ZipFileUtil {
  /**
   * 创建zip文件
   * @param zipFilePath zip文件路径
   * @param fileList 压缩进 zip 的文件列表
   * @param options 压缩参数, 默认{ zlib: { level: 9 } }
   */
  static createZipFile(zipFilePath, fileList, options) {
    return new Promise((resolve, reject) => {
      const output = _fs.default.createWriteStream(zipFilePath);
      const archiver = (0, _archiver.default)('zip', {
        zlib: {
          level: 9
        },
        ...options
      });
      output.on('close', () => {
        console.log('close');
        resolve();
      });
      output.on('error', error => {
        reject(error);
      });
      fileList.forEach(item => {
        archiver.append(_fs.default.createReadStream(item.filePath), {
          name: item.zipFilePath
        });
      });
      archiver.pipe(output);
      archiver.finalize();
    });
  }
}
var _default = exports.default = ZipFileUtil;