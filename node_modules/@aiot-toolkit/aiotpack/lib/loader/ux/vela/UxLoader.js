"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _path = _interopRequireDefault(require("path"));
var _UxLoaderUtils = _interopRequireDefault(require("../../../utils/ux/UxLoaderUtils"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
class UxLoader {
  async parser(files) {
    const resultFiles = [];
    const {
      projectPath
    } = this.context;
    for (const file of files) {
      // 转换每个文件
      const {
        files: compiledFiles,
        logs
      } = await _UxLoaderUtils.default.compileUxToJavascript(file, this.context, false, this.compilerOption);
      this.logs = logs.map(item => {
        return {
          ...item,
          filePath: item.position?.source ? item.position.source : item.filePath ? _path.default.relative(projectPath, item.filePath) : ''
        };
      });
      resultFiles.push(...compiledFiles);
    }
    return resultFiles;
  }
}
var _default = exports.default = UxLoader;