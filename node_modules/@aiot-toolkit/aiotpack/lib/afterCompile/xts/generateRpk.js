"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.generateRpk = void 0;
var _path = _interopRequireDefault(require("path"));
var _XtsFollowWorks = _interopRequireDefault(require("../../utils/xts/XtsFollowWorks"));
var _sharedUtils = require("@aiot-toolkit/shared-utils");
var _ts2wasm = require("./ts2wasm");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
const generateRpk = async params => {
  const {
    context,
    compilerOption
  } = params;
  if (compilerOption?.skip?.includes('package')) {
    _sharedUtils.ColorConsole.info(`### skip package due to --skip ${compilerOption.skip.join(',')}`);
    return;
  }
  const manifestPath = _path.default.resolve(context.projectPath, 'app', 'manifest.json');
  const manifest = await import(manifestPath);
  return _XtsFollowWorks.default.defaultZipProject(context, {
    tarDir: _ts2wasm.wasmPackageName,
    packageName: manifest.package
  });
};
exports.generateRpk = generateRpk;