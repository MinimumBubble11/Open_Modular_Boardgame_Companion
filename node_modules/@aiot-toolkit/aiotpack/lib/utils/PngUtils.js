"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _fsExtra = _interopRequireDefault(require("fs-extra"));
var _path = _interopRequireDefault(require("path"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
/**
 * PngUtils
 */
class PngUtils {
  /**
   * 检测.9.png是否编码
   * @param filePath
   * @returns
   */
  static isEncode9Png(filePath) {
    const buff = _fsExtra.default.readFileSync(filePath);
    const start = 37;
    const end = 41;
    const encode = buff.subarray(start, end).toString() === 'npTc' || buff.subarray(start, end).toString() === 'npOl';
    return encode;
  }
  /**
   * 计算文件转换后的目标路径
   * @param filePath
   * @param context
   * @returns
   */
  static convertOutputPath(filePath, context) {
    const {
      projectPath,
      output
    } = context;
    const fileRelativePath = _path.default.relative(projectPath, filePath);
    const outputPath = _path.default.join(projectPath, output, fileRelativePath);
    const outputDir = _path.default.dirname(outputPath);
    // 判断输出文件夹是否存在，不存在则循环创建
    if (!_fsExtra.default.existsSync(outputDir)) {
      _fsExtra.default.mkdirSync(outputDir, {
        recursive: true
      });
    }
    return outputPath;
  }
}
var _default = exports.default = PngUtils;