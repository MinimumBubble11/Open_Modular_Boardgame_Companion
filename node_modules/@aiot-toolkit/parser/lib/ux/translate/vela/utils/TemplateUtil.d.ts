import { Dictionary, IPosition } from '@aiot-toolkit/shared-utils';
import { Attribute, Location } from 'aiot-parse5/dist/common/token';
import { ChildNode, Element, TextNode } from 'aiot-parse5/dist/tree-adapters/default';
import IOptions from '../../../config/IOptions';
import { IAttributeNode, IIdentifierNode } from '../../../interface/IIdentifierNode';
import ITemplateContext from '../../../interface/ITemplateContext';
import ITemplateValueResult from '../../../interface/ITemplateValueResult';
import ElementConfigUtil from '../../../utils/ElementConfigUtil';
import ITranslateOption from '../../../interface/ITranslateOption';
/**
 * TemplateUtil
 */
declare class TemplateUtil {
    private readonly context;
    private readonly option;
    private readonly elementConfigUtil;
    static DYNAMIC_REG: string;
    constructor(context: ITemplateContext, option: IOptions, elementConfigUtil: ElementConfigUtil);
    /**
     * 属性列表转换为字典格式
     *
     * @param obj
     * @returns
     */
    attributesToObject(options: IOptions, attributes: Attribute[], identifiers: string[], params?: {
        /**
         * 是否分离 models 属性，默认 false
         *
         * true 表示:  `model:NAME="VALUE"`会解析到结果的 models 属性上
         * false 表示：和普通属性一样处理
         *
         * 目前需求：在 android 上需要分享，vela 不需要
         */
        separateModelValue?: boolean;
        /**
         * 是否将属性名称转换为驼峰格式，默认 false
         */
        nameToCamel?: boolean;
    }): Dictionary;
    /**
     * 转换属性名称
     * 1. 配置中有别名，使用别名
     * 2. 如果是@， on开头，则取@ on后面的文本
     * 3. 原名称
     * @param name
     */
    private translateAttributeName;
    /**
     * 转换属性值
     * 1. 无内容=true
     * 2. 非字符串，直接返回结果
     * 3. 属性值转换为 js 代码
     *    a. 如果有单独的配置，则使用配置转换
     *    b. 否则，如果是动态值，则分为事件和其它动态值
     *    c. 否则，返回源内容
     * @param attribute
     * @returns
     */
    translateAttributeValue(options: IOptions, attribute: IAttributeNode, identifiers: string[], disabledWrap?: boolean): any;
    /**
     * 解析模板值
     *
     * 1. 使用TemplateValueParser.parse 解析出结果列表
     * 2. 循环结果列表
     *    a. 代码：部分标识符加上前缀
     *    b. 文字：加上引号
     * 3. 使用+连接各项结果
     *
     * @param source 模板值的原始内容: a{{b}}c
     * @param identifiers 已存在的标识符. 存在于此参数中的标识符，不加前缀
     * @param options
     * @param ownerNode source 模板值所属的属性节点:  for="forvalue", 表示for 这个节点
     *
     * @returns
     */
    translateTemplateValue(source: string, identifiers: string[], options: IOptions, ownerNode?: IAttributeNode): ITemplateValueResult;
    createWrapCallExpression(struct: {
        name: string;
        opts: any;
        elementExpression: string;
    }): string;
    /**
     * 创建元素调用表达式
     * ```
     * aiot.__ce__(
     *  "div",
     *  {name:'div1'},
     *  children
     * )
     * ```
     * @param struct
     * @returns
     */
    createElementCallExpression(options: IOptions, struct: {
        /**
         * 函数名，例如 __ce__
         */
        callerName: string;
        /**
         * 元素名称，例如 div
         */
        tag: IIdentifierNode;
        /**
         * 属性列表
         */
        attributes: IAttributeNode[];
        children: string;
        /**
         * 外部引入的 import 的name列表，例如 ['a', 'b']
         */
        importList?: string[];
        /**
         * 已存在的标识符，已存在的标识符，不加上_vm_前缀
         */
        identifiers: string[];
    }): string;
    /**
     * 获取节点指定名称的属性
     *
     * 此方法会排除修饰符，例如<div for.static="123" />；使用getAttribute(node, "for") 仍可取到值
     *
     * @param node
     * @param name
     * @returns
     */
    static getAttribute(node: Element, name: string): IAttributeNode | undefined;
    /**
     * 解析属性名为名称、修饰符
     *
     * 以 attr.x.y.z="123"为例
     * + 属性名使用.分隔为数组 [attr, x, y, z]
     * + 第0项为属性名，1-最后一项为修饰符名
     * @param name
     * @returns
     */
    static parseAttributeName(name: string): {
        attributeName: string;
        decorator?: string[];
    };
    /**
     * 判断是否强制为动态值
     * 1. 事件属性
     * 2. if  for
     * 3. 配置值
     * @param nodeName 节点名称
     * @param attributeName 属性名称
     * @returns
     */
    isForceDynamicAttribute(nodeName: string, attributeName: string): boolean;
    static parse5LocationToPosition(location?: Location | null): IPosition | undefined;
    static translateEventName(name: string): string;
    static isText(node: ChildNode): node is TextNode;
    /**
     * 是否为节点元素
     *
     * @example <span></span>
     * @param node
     * @returns
     */
    static isElement(node: ChildNode): node is Element;
    static isDynamicValue(value: string): boolean;
    static isEventAttribute(name: string): boolean;
    /**
     * 是否是 model 指令的属性
     * @param name
     * @returns
     */
    static isModelAttribute(name: string): boolean;
    /**
     * 解析model 指令属性的名称为： {modelName: '', modelValue: ''}
     *
     * 例如 `model:abcde="xyz"` 解析为 `{modelName: 'abcde', modelValue:'xyz'}`
     * @param name
     */
    parseModelAttribute(node: Attribute): {
        modelName: string;
        modelValue: string;
    } | undefined;
    /**
     * 值转换为动态值
     *
     * 如果已经是动态值，则不做修改
     * @param value
     * @returns
     */
    static toDynamicValue(value: string): string;
    /**
     * 值转换为静态值
     *
     * 已经是静态值，不做修改
     * @param value
     * @returns
     */
    static toStaticValue(value: string): string;
    /**
     * 创建修饰符数据
     *
     *
     * @example createDecoratorData(node, 'if', 'shown')
     *
     * 如果 node 有 if 属性, 例如<div if.static1.static2="aaa" />，则创建属性名为shown的修改符对象
     * ```
     * {
     *   shown:{static1: true,static2: true}
     * }
     * ```
     * @param node
     * @param attributeName
     * @param decoratorName
     * @returns
     */
    static createDecoratorData(node: Element, attributeName: string, decoratorName: string): {
        [x: string]: {
            [k: string]: boolean;
        };
    } | undefined;
    /**
     * 条件列表转换为表达式
     *
     * 转换规则为：前置条件全部取反 && 自身条件
     *
     * @param condition
     * @returns
     */
    genIfConditionList(condition: {
        selfCondition?: IAttributeNode;
        preConditions?: IAttributeNode[];
    }, identifiers: string[]): string;
    /**
     * 获取 `if` 的条件列表
     *
     * 1. selfCondition=需要取节点身的条件
     * 2. preConditions=前置节点的条件--当前节点是 elif   else 时，需要取前置节点
     * @param node
     * @param options
     * @returns
     */
    static getIfCoditionList(node: Element, options: IOptions): {
        selfCondition?: IAttributeNode;
        preConditions?: IAttributeNode[];
    } | undefined;
    /**
     * 元素的属性转换为资源路径
     * 1. 属性本身无需转换，不处理
     * 2. 是动态值、绝对路径，不处理
     * 3. 如果是静态值
     *    3.1. 如果文件在src中，转换为相对src的路径: 例如project/src/assets/a/b.png 转换为 /assets/a/b.png
     *    3.2. 否则修改为 require()
     */
    convertResourcePath(nodeName: string, attrs: IAttributeNode[], compilerOption: ITranslateOption): void;
    /**
     * 获取节点中的文字内容
     *
     * 1. 如果是文字元素，返回 value
     * 1. 循环子元素列表
     *    1. 如果子元素是文本，直接返回内容
     *    2. 否则，如果子元素允许文本，则递归获取结果
     * 2. 文字中连续的特定符号[\r\n\t ]
     *    1. 首尾的替换为空字符串
     *    2. 其它替换为1个空格
     *
     * @example
     * `
     *    a
     *    b
     *
     * ` --> `a b
     *
     * @param node
     */
    getTextContent(node: Element | TextNode, elementConfig: ElementConfigUtil): string;
}
export default TemplateUtil;
